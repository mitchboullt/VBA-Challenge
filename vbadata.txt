Sub vbahw()'Set ws as variable'set variable to hold ticker nameDim ticker As String'set variable for holding total volumeDim volume As Single'keep track of the location of each ticker name in the summary tableDim tablerow As Integer'keep track of opening priceDim op As Double'keeptrack of closing priceDim clo As Double'keep track of greasted percent changeDim max As Double'keep track of greatest drecent decreaseDim Min As Double'keep track of greatest volumeDim max2 As SingleFor Each ws In Worksheets'set initial volumevolume = 0'set intial data table rowtablerow = 1'deterime lastrowlastrow = Cells(Rows.Count, 1).End(xlUp).Row'format tablews.Range("i1").Value = "Ticker"ws.Range("j1").Value = "Yearly Change"ws.Range("k1").Value = "Percent Change"ws.Range("l1").Value = "Total Volume"ws.Range("p1").Value = "Ticker"ws.Range("q1").Value = "Value"ws.Range("o2").Value = "Greatest % Increase"ws.Range("o3").Value = "Greatest % Decrease"ws.Range("o4").Value = "Greatest Total Volume"ws.Range("k2:k" & lastrow).NumberFormat = "0.00%"ws.Range("q2:q3").NumberFormat = "0.00%"ws.Range("q4").NumberFormat = "00000000000"'determine intial open priceop = ws.Range("c2").Value'create a for loop that cycles throug the ticker column to detect change of tickerFor i = 2 To lastrow    'add up the volumes    volume = volume + ws.Cells(i, 7).Value        If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1) Then    ticker = ws.Cells(i, 1).Value    'add row to table    tablerow = tablerow + 1    'determine closing value    clo = ws.Cells(i, 6).Value    'list the new tiker label    ws.Range("i" & tablerow).Value = ticker    'list the new total volume    ws.Range("l" & tablerow).Value = volume    'list yealry change    ws.Range("j" & tablerow).Value = (clo - op)    'list percent change    ws.Range("k" & tablerow).Value = (clo - op) / op    'set new opening price    op = ws.Cells(i + 1, 3)    'reset volume    volume = 0       End IfNext i'determine tnew last rowlrow = Cells(Rows.Count, 9).End(xlUp).Row'find the greatest percent increasemax = WorksheetFunction.max(ws.Range("k:k"))'find the greatest percent decresaseMin = WorksheetFunction.Min(ws.Range("k:k"))'find the greast total volumemax2 = WorksheetFunction.max(ws.Range("l:l"))'isolate the above valuesws.Range("q2").Value = maxws.Range("q3").Value = Minws.Range("q4").Value = max2For i = 2 To lrow    'create a conditional to color code positive and negative yeary change   If ws.Cells(i, 10) < 0 Then    ws.Cells(i, 10).Interior.ColorIndex = 3    ElseIf ws.Cells(i, 10).Value > 0 Then    ws.Cells(i, 10).Interior.ColorIndex = 4        End If        'create a nested for loop to find the correlated ticker for max, min and max2    For j = 10 To 12        If ws.Cells(i, j).Value = max Then   ws.Range("p2").Value = ws.Cells(i, j - 2).Value        ElseIf ws.Cells(i, j).Value = Min Then    ws.Range("p3").Value = ws.Cells(i, j - 2).Value    ElseIf ws.Cells(i, j).Value = max2 Then    ws.Range("p4").Value = ws.Cells(i, j - 3).Value        End If    Next jNext iNextEnd Sub